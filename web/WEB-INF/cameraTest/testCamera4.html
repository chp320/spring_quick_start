<!DOCTYPE html>
<html lang="ko">
<head>
  <meta name="viewport" content="width=320; user-scalable=no" />
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Camera</title>
  <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
</head>
<body>

  <form>
    <p>
      <label for="camera">camera:</label>
      <input type="file" id="camera" name="camera" capture="camera" accept="image/*" />
    </p>
  </form>

  <div id="image_preview" style="width: 100px; height: 200px" >
    <img src="#" style="width: 100%; height: 100%"/>
  </div>

  <br>

  <div id="delete">
    <a href="#">delete</a>
  </div>

  <script type="text/javascript">

    $('#camera').on('change', function () {
      alert("111") ;
      // 전체 경로 확인
      ext = $(this).val();
      alert(ext);

      file = $('#camera').prop("files")[0];
      alert(file);

      // blobURL 생성
      blobURL = window.URL.createObjectURL(file);
      alert(blobURL);

      // img 태그에 연결
      $('#image_preview img').attr('src', blobURL);
      alert("222");

      // 이미지 미리보기
      $('#image_preview').slideDown();
      alert("333");
    }) ;

    /**
     onclick event handler for the delete button.
     It removes the image, clears and unhides the file input field.
     */
    $('#delete').on('click', function() {
      alert("delete!!");

      // 전체 경로 확인
      // ext = $(this).val();
      // alert(ext);

      // 생성된 blobURL 삭제
      // window.URL.createObjectURL($('#camera').prop("files")[0]);

      resetFormElement($('#camera')); //전달한 양식 초기화
      alert("111");

      $('#camera').slideDown(); //파일 양식 보여줌
      alert("222");
      $(this).parent().slideUp(); //미리 보기 영역 감춤
      alert("333");
      return false; //기본 이벤트 막음
    });


    /**
     * 폼요소 초기화
     * Reset form element
     *
     * @param e jQuery object
     */
    function resetFormElement(e) {
      alert("reset!!!");
      e.wrap('<form>').closest('form').get(0).reset();
      //리셋하려는 폼양식 요소를 폼(<form>) 으로 감싸고 (wrap()) ,
      //요소를 감싸고 있는 가장 가까운 폼( closest('form')) 에서 Dom요소를 반환받고 ( get(0) ),
      //DOM에서 제공하는 초기화 메서드 reset()을 호출
      e.unwrap(); //감싼 <form> 태그를 제거
    }

  </script>

</body>
</html>